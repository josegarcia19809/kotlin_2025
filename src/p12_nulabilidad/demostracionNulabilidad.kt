package p12_nulabilidad

// üéØ Objetivo: mostrar c√≥mo manejar nulos y conversiones seguras en Kotlin
// Operadores clave:
//  - ?.  ‚Üí llamada segura (si es null, la expresi√≥n retorna null)
//  - ?:  ‚Üí Elvis (valor por defecto cuando es null)
//  - !!  ‚Üí afirmaci√≥n no nula (‚ö†Ô∏è lanza NullPointerException si es null)
//  - as? ‚Üí conversi√≥n/cast seguro (si falla, devuelve null en lugar de lanzar excepci√≥n)

fun demostracionNulabilidad() {
    // 1) Variable que puede ser nula
    val cadenaNula: String? = null

    // 2) ‚ö†Ô∏è EJEMPLO NO RECOMENDADO: afirmaci√≥n no nula
    //    Descomentar la l√≠nea siguiente lanzar√≠a NullPointerException:
    //    val mayusPeligro = cadenaNula!!.uppercase()

    // 3) Llamada segura: si 'cadenaNula' es null, toda la expresi√≥n es null
    println("May√∫sculas (seguro): ${cadenaNula?.uppercase()}")  // imprime: May√∫sculas (seguro): null

    // 4) Operador Elvis: si es null, usa un valor por defecto
    val textoConDefault = cadenaNula ?: "Valor por defecto"
    println(textoConDefault)  // imprime: Valor por defecto

    // 5) Ejemplo t√≠pico de encadenar con Elvis (modelo de dominio)
    // val pais = sucursal?.direccion?.pais ?: "MX"

    // 6) Conversi√≥n segura (as?): no lanza excepci√≥n, devuelve null si no se puede convertir
    val algo: Any = arrayOf(1, 2, 3, 4)   // 'algo' NO es String
    val comoTexto: String? = algo as? String
    println(comoTexto)                    // imprime: null
    println(comoTexto?.uppercase())       // imprime: null (llamada segura)
}

// üéØ Objetivo: demostrar el uso de variables nulas, let, comparaciones y el operador !! en Kotlin

fun demostrarUsoVariablesNulas() {
    // 1) Variable que puede ser nula (nullable)
    val cadenaOpcional: String? = "Este texto no es nulo"

    // Usamos let con llamada segura (?.)
    // Si la variable no es null, ejecuta el bloque y manda el valor a la funci√≥n
    cadenaOpcional?.let { imprimirTexto(it) }   // imprime: "Este texto no es nulo"

    // 2) Comparaci√≥n entre null y una cadena no nula
    val otraCadenaNula: String? = null
    val cadenaNormal: String = "Este texto no es nulo"
    println(otraCadenaNula == cadenaNormal)     // imprime: false

    // 3) Operador !! (afirmaci√≥n no nula)
    // ‚ö†Ô∏è Lanza NullPointerException si la variable resulta ser null
    val cadenaForzada: String = cadenaOpcional!!
    val enMayusculas = cadenaForzada.uppercase()
    println(enMayusculas)   // imprime: "ESTE TEXTO NO ES NULO"
}

// Funci√≥n simple que imprime un texto
fun imprimirTexto(texto: String) {
    println(texto)
}

fun main() {
    demostracionNulabilidad()
    println("-".repeat(100))
    demostrarUsoVariablesNulas()
}